Task description: fill in the algorithm and supporting annotations such that the provided formal specification verifies. Note the formal spec may rely on helper functions in its expression.

